<!-- <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SL Courier - Manage Payments</title>
    <link rel="stylesheet" href="admin.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
    <header>
        <nav class='nav-bar'>
            <ul>
                <li class='logo'><img src="../images/logo.png" alt="">SL Courier</li>
                <li><a href="index.html">Package Routing</a></li>
                <li><a href="manage_driver.html">Manage Drivers</a></li>
                <li><a href="manage_package.html">Manage Packages</a></li>
                <li><a href="manage_payments.html">Manage Payments</a></li>
            </ul>
        </nav>
    </header>

    <main>
        <div class="container">
            <header>
                <h1>Manage Payments</h1>
            </header>

            <section id="updatePaymentMethod">
                <div class="description">
                    <form id="paymentForm">
                        <div id="Pid_payment">
                            <label for="r_package"><span>Package ID</span></label>
                            <select class="field_effect" id="r_package" name="packageID" required>
                                <option value="">Select a package</option>
                            </select>
                        </div>

                        <div id="paymentMethod">
                            <label for="payment_method"><span>Payment Method</span></label>
                            <select class="field_effect" id="payment_method" name="payment_method" required>
                                <option value="">Select payment method</option>
                                <option value="credit_card">Credit Card</option>
                                <option value="cash_on_delivery">Cash on Delivery</option>
                            </select>
                        </div><br><br>

                        <div id="extraCharges">
                            <label for="extra_charges"><span>Extra charges</span></label>
                            <input type="number" class="field_effect" placeholder="money in $" id="extra_charges" name="extra_charges" required>
                        </div><br><br>

                        <div id="payment_submit">
                            <input class="button" type="submit" value="Submit">
                        </div>
                    </form>
                </div>
            </section>
        </div>
    </main>

    <footer>
        <span>2024 © StreamLine Courier Services Pvt. Limited. All rights reserved</span>
        <a href="#">Privacy Policy</a>
    </footer>

    <script>
        $(document).ready(function() {
            // Load all packages with status not 'delivered'
            $.get('/packages', function(data) {
                data.forEach(function(package) {
                    $('#r_package').append(`<option value="${package.packageID}">${package.packageID}</option>`);
                });
            });

            // Handle package selection
            $('#r_package').change(function() {
                const packageID = $(this).val();
                if (packageID) {
                    $.get(`/payment-method/${packageID}`, function(data) {
                        $('#payment_method').val(data.payMethod);
                    });
                }
            });

            // Handle form submission
            $('#paymentForm').submit(function(event) {
                event.preventDefault();
                const packageID = $('#r_package').val();
                const paymentMethod = $('#payment_method').val();
                const extraCharges = parseFloat($('#extra_charges').val());

                if (packageID && paymentMethod && !isNaN(extraCharges)) {
                    $.post('/update-payment', { packageID, paymentMethod, extraCharges }, function(response) {
                        alert(response.message);
                    }).fail(function() {
                        alert('Error updating payment details.');
                    });
                } else {
                    alert('Please fill in all fields.');
                }
            });
        });
    </script>
</body>
</html> -->




<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SL Courier - Manage Payments</title>
    <link rel="stylesheet" href="admin.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
    <header>
        <nav class='nav-bar'>
            <ul>
                <li class='logo'><img src="../images/logo.png" alt="">SL Courier</li>
                <li><a href="index.html">Package Routing</a></li>
                <li><a href="manage_driver.html">Manage Drivers</a></li>
                <li><a href="manage_package.html">Manage Packages</a></li>
                <li><a href="manage_payments.html">Manage Payments</a></li>
            </ul>
        </nav>
    </header>

    <main>
        <div class="container">
            <header>
                <h1>Manage Payments</h1>
            </header>

            <section id="updatePaymentMethod">
                <div class="description">
                    <form id="paymentForm">
                        <div id="Pid_payment">
                            <label for="r_package"><span>Package ID</span></label>
                            <select class="field_effect" id="r_package" name="packageID" required>
                                <option value="">Select a package</option>
                            </select>
                        </div>

                        <div id="paymentMethod">
                            <label for="payment_method"><span>Payment Method</span></label>
                            <select class="field_effect" id="payment_method" name="payment_method" required>
                                <option value="">Select payment method</option>
                                <option value="credit_card">Credit Card</option>
                                <option value="cash_on_delivery">Cash on Delivery</option>
                            </select>
                        </div><br><br>

                        <div id="extraCharges">
                            <label for="extra_charges"><span>Extra charges</span></label>
                            <input type="number" class="field_effect" placeholder="money in $" id="extra_charges" name="extra_charges" required>
                        </div><br><br>

                        <div id="payment_submit">
                            <input class="button" type="submit" value="Submit">
                        </div>
                    </form>
                </div>
            </section>
        </div>
    </main>

    <footer>
        <span>2024 © StreamLine Courier Services Pvt. Limited. All rights reserved</span>
        <a href="#">Privacy Policy</a>
    </footer>

    <script>
        $(document).ready(function() {
            // Load all packages with status not 'delivered'
            $.get('/packages', function(data) {
                data.forEach(function(package) {
                    $('#r_package').append(`<option value="${package.packageID}">${package.packageID}</option>`);
                });
            });

            // Handle package selection
            $('#r_package').change(function() {
                const packageID = $(this).val();
                if (packageID) {
                    $.get(`/payment-method/${packageID}`, function(data) {
                        $('#payment_method').val(data.payMethod);
                    });
                }
            });

            // Handle form submission
            $('#paymentForm').submit(function(event) {
                event.preventDefault();
                const packageID = $('#r_package').val();
                const paymentMethod = $('#payment_method').val();
                const extraCharges = parseFloat($('#extra_charges').val());

                if (packageID && paymentMethod && !isNaN(extraCharges)) {
                    $.post('/update-payment', { packageID, paymentMethod, extraCharges }, function(response) {
                        // Instead of alert, you can use a different method to notify success or handle accordingly
                        window.location.reload(); // Reload the page to reflect changes
                    }).fail(function() {
                        // Handle failure case
                        console.error('Error updating payment details.');
                    });
                } else {
                    alert('Please fill in all fields.');
                }
            });
        });
    </script>
</body>
</html>
